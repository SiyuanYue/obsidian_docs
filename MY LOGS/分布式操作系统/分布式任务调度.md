# 分布式调度 —Elastic-Job
## 分布式任务调度概念
任务调度是指系统为了自动完成特定任务，在约定的特定时刻去执行任务的过程。
什么是分布式任务调度？
通常任务调度的程序是集成在应用中的，比如: 优惠券服务中包括了定时发放优惠券的调度程序, 结算服务中包括了定期生成报表的任务调度程序，由于采用分布式架构，一个服务往往会部署多个冗余实例来运行业务，在这种分布式系统环境下运行任务调度，称之为分布式任务调度。
![[分布式任务调度.png]]

#### 组成 ：
- 协调器/调度中心：任务分配

- 执行器：任务执行

- 可视化平台Dashboard：任务管理，增删改查，执行、配置、统计

#### 调度分类
- 定时任务多用于单机定时场景。
    
- 分布式调度系统（分片调度系统）用于任务的分片执行场景。场景：定时生成一批商品清单、支付清算跑批、定时对一批用户发送推送通知等等。框架：Elastic-job、XXL-Job、PowerJob
    
- 工作流调度系统（大数据调度系统）用于任务的流程化处理场景。场景：大数据的离线数据仓报表处理业务：从数据采集、清洗、各个层级的报表汇总运算、数据导出。框架：Apache DolphinScheduler
    
- 集群调度系统底层物理资源的分配管理，目标是最大化利用集群机器硬件资源。例如：K8s、阿里伏羲


#### 轻量设计架构图
![[分布式任务调度-1.png]]
包括了管理端、集群管理（协调器）、执行节点（执行器）和Zookeeper四个部分。
- 管理端：主要负责任务的增删改查操作。
- 集群管理（协调器）：主要负责节点发现和任务执行管理。
- 执行节点（执行器）：主要负责存储任务执行信息。
- Zookeeper：主要负责对执行任务信息的存储，并实现选举机制，在任务执行实例数量变化时，触发选举机制来决定让哪个实例去执行该任务。

在架构图中，管理端通过task-manage Dashboard与task-center调度中心进行交互，而task-center调度中心则通过DB存储任务信息，并通过Zookeeper进行协调和管理。执行器（Job-executor）则通过Zookeeper获取任务信息并执行任务。
#### 分布式架构设计比较

| 对比维度 | XXL-Job | Elastic-job | PowerJob |
| ---- | ------- | ----------- | -------- |
| 语言   | Java    | Java        | Java     |
| 集群分发 | Nginx   | Zookeeper   | akka     |
| 统计报表 | 有       | 有           | 有        |
| 高可用  | N+1     | N+1         | 水平扩展     |
| 作业管理 | 控制台     | Restful/控制台 | 控制台      |
| 容器化  | Docker  | Mesos       | Docker   |
| 社区   | 活跃      | 不活跃；20.07复活 | 藤佶祺/阿里   |
容器化是指将软件代码和所需的所有组件（例如库、框架和其他依赖项）打包在一起，让它们隔离在自己的"[容器](https://www.redhat.com/zh/topics/containers/whats-a-linux-container)"中。




